<?phpdefined('BASEPATH') OR exit('No direct script access allowed');?><link rel="stylesheet" href="<?php echo base_url(); ?>css/order/rating.css"><script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCD2xGIJMaWN7WReKZH0ZxabhGG_i58NKA&sensor=false&libraries=places"></script><script type="text/javascript" src="<?php echo base_url(); ?>js/richmarker-compiled.js"></script><script type="text/javascript">    var map;    var mapScrollEnabled = true;    var mapDraggableEnabled = true;    var userLocLat;    var userLocLon;    var eddressLat;    var eddressLon;    var markers = [];    var ratingValue;    var feedbackValue;    $(document).ready(function () {      //      //  $('#eddress_action_bar').show();        $('#preload').hide();    //    ratingValue = 1;     //   $('#f1').removeClass();    //    $('#f1').addClass("emojiImgSelected");        $('#other_textarea').hide();        $( "#f1" ).click(function() {            $('#feedback_questions').show();            $('#eddress_action_bar').show();            $('#other_textarea').hide();            ratingValue = 1;            $('#f1').removeClass();            $('#f1').addClass("emojiImgSelected");            $('#f2').removeClass();            $('#f2').addClass("emojiImg");            $('#f3').removeClass();            $('#f3').addClass("emojiImg");            $('#f4').removeClass();            $('#f4').addClass("emojiImg");        });        $( "#f1" ).click(function() {            $('#other_textarea').hide();            $('#feedback_questions').show();            $('#eddress_action_bar').show();            ratingValue = 1;            $('#f1').removeClass();            $('#f1').addClass("emojiImgSelected");            $('#f2').removeClass();            $('#f2').addClass("emojiImg");            $('#f3').removeClass();            $('#f3').addClass("emojiImg");            $('#f4').removeClass();            $('#f4').addClass("emojiImg");        });        $( "#f2" ).click(function() {            $('#other_textarea').hide();            $('#feedback_questions').show();            $('#eddress_action_bar').show();            ratingValue = 2;            $('#f2').removeClass();            $('#f2').addClass("emojiImgSelected");            $('#f1').removeClass();            $('#f1').addClass("emojiImg");            $('#f3').removeClass();            $('#f3').addClass("emojiImg");            $('#f4').removeClass();            $('#f4').addClass("emojiImg");        });        $( "#f3" ).click(function() {            $('#feedback_questions').show();            $('#eddress_action_bar').show();            ratingValue = 3;            $('#other_textarea').hide();            $('#f3').removeClass();            $('#f3').addClass("emojiImgSelected");            $('#f2').removeClass();            $('#f2').addClass("emojiImg");            $('#f1').removeClass();            $('#f1').addClass("emojiImg");            $('#f4').removeClass();            $('#f4').addClass("emojiImg");        });        $( "#f4" ).click(function() {            $('#feedback_questions').hide();            $('#eddress_action_bar').show();            ratingValue = 4;			feedbackValue = "other";            $('#other_textarea').show();            $('#f4').removeClass();            $('#f4').addClass("emojiImgSelected");            $('#f3').removeClass();            $('#f3').addClass("emojiImg");            $('#f2').removeClass();            $('#f2').addClass("emojiImg");            $('#f1').removeClass();            $('#f1').addClass("emojiImg");        });        var isMobile = {            Android: function () {                return navigator.userAgent.match(/Android/i);            },            BlackBerry: function () {                return navigator.userAgent.match(/BlackBerry/i);            },            iOS: function () {                return navigator.userAgent.match(/iPhone|iPad|iPod/i);            },            Opera: function () {                return navigator.userAgent.match(/Opera Mini/i);            },            Windows: function () {                return navigator.userAgent.match(/IEMobile/i);            },            any: function () {                return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows());            }        };        if (isMobile.Android()) {            $('#store_url').attr('href', 'https://play.google.com/store/apps/details?id=com.eddress');        }else if (isMobile.iOS()) {            $('#store_url').attr('href', 'https://itunes.apple.com/app/id1012242546');        } else {            $("#gettheappmenu").addClass('hidden-xs');        }        $(document)            .on('open.fndtn.offcanvas', '[data-offcanvas]', function () {                $('#off-canvas-wrap').css('overflow-y', 'hidden');            })            .on('close.fndtn.offcanvas', '[data-offcanvas]', function () {                $('#off-canvas-wrap').css('overflow-y', 'auto');            });        $('#sharebox').hide();        $('#searchInput_medium').hide();        $('#loader_image').hide();        $('#close_image').hide();        $('#close_fullscreen').hide();        $('#bar-profile').hide();    });    $(function () {        $('#searchText').click(function () {            $('#searchText').hide();            $('#searchTextInput').focus();        });        $('#searchText_medium').click(function () {            $('#searchText_medium').hide();            $('#searchInput_medium').show();            $('#searchTextInput_medium').focus();        });        $("#searchTextInput_medium").blur(function () {            $('#searchInput_medium').hide();            $('#searchText_medium').show();        });        $('#details_body').click(function () {            if (parseInt($('#details_box').css("marginTop")) > 250) {                $('#details_box').animate(                    {                        'marginTop': "250px"                    },                    400,                    'easeOutQuart'                );                map.setOptions({'scrollwheel': false});                map.setOptions({'draggable': false});            }        });        $("#close_image").click(function (event) {            $("#searchTextInput").val('');            $('#details_box').fadeOut();            $('#details_box').animate({                'marginTop': "1000px" //moves down            }, 100);            $("#close_image").hide();            $("#loop_image").show();            $('#searchText').show();        });        $('#close_fullscreen').click(function () {            hideDetailsBox();        });        $('#audio_play').click(function () {            wavesurfer.playPause();            $('#audio_play').toggleClass("pausebutton")        });        $('#sharebox_closebtn').click(function () {            $('#sharebox').hide();        });        $('#emailpopup_closebtn').click(function () {            $('#sharebyemail_popup').hide();        });        $('#share_div').click(function () {            $('#sharebox').show();        });        $('#share_email_btn').click(function () {            $('#sharebyemail_popup').show();        });        $('#show_map').click(function () {            showDetailsBox();        });        $("#feedback_div").click(function(){            var rating = ratingValue;            var feedback = feedbackValue;            var orderNumber = '<?php echo $orderNumber; ?>';			if(feedback == "other"){				feedback = $("textarea#other_textareainput").val();			}			if(rating > 4){				feedback = '';			}            jQuery.ajax({                type: "POST",                url: "<?php echo base_url(); ?>o/send_feedback",                dataType: 'json',                data: {                    'rating': rating,                    'feedback': feedback,                    'orderNumber': orderNumber                },                success: function (res) {                    if (res == 1) {                        window.location.reload();                    } else {                        window.location.reload();                    }                },                error: function (error) {                    window.location.reload();                }            });        });    });    function deleteMarkers() {        for (var i = 0; i < markers.length; i++) {            markers[i].setMap(null);        }        markers = [];    }    function attachInfoWindow(marker, message) {        var infowindow = new google.maps.InfoWindow({            content: message        });        marker.addListener('click', function () {            infowindow.open(marker.get('map'), marker);        });    }    function attachInfoWindowWithOffset(marker, message) {        var infowindow = new google.maps.InfoWindow({            content: message,            pixelOffset: new google.maps.Size(0, -40)        });        marker.addListener('click', function () {            infowindow.open(marker.get('map'), marker);        });    }    function addMapClickHandler() {        google.maps.event.addListener(map, 'click', function (event) {            showDetailsBox();        });    }    function showDetailsBox() {        $('#details_box').fadeOut(800, function () {            map.setOptions({'scrollwheel': true});            map.setOptions({'draggable': true});            map.setOptions({'mapTypeControl': true});        });        $('#bar-profile').addClass("visible-xs");        $('#openinapp').removeClass("visible-xs");        $('#search-button').hide();        $('#close_fullscreen').show();        $('#show_map').hide();    }    function hideDetailsBox() {        $('#details_box').fadeIn(800, function () {            map.setOptions({'scrollwheel': false});            map.setOptions({'draggable': false});            map.setOptions({'mapTypeControl': false});        });        $('#bar-profile').removeClass("visible-xs");        $('#openinapp').addClass("visible-xs");        $('#search-button').show();        $('#close_fullscreen').hide();        $('#show_map').show();    }    function getUserLocation() {        if (navigator.geolocation) {            navigator.geolocation.getCurrentPosition(function (position) {                userLocLat = position.coords.latitude;                userLocLon = position.coords.longitude;                postUserLocation();            }, function () {                getUserLocationFromIP();            },{timeout:5000});        } else {            // Browser doesn't support Geolocation            getUserLocationFromIP();        }    }    function getUserLocationFromIP() {        $.get("http://ipinfo.io", function (response) {            var userLocation = response.loc;            var commaPos = userLocation.indexOf(',');            userLocLat = parseFloat(userLocation.substring(0, commaPos));            userLocLon = parseFloat(userLocation.substring(commaPos + 1, userLocation.length));            postUserLocation();        }, "jsonp");    }    function postUserLocation() {        if (eddressLat && eddressLon) {            $("#direction_link").attr("href", "http://maps.google.com/?saddr=" + userLocLat + "," + userLocLon + "&daddr=" + eddressLat + ", " + eddressLon);        } else {            //center map based on user location            var pos = new google.maps.LatLng(userLocLat, userLocLon);            map.setCenter(pos);        }    }    function radioValueChange() {        var filterValue = $('#questions_group input:radio:checked').val();        feedbackValue = filterValue;    //    alert(feedbackValue);        if (filterValue == "other") {            $('#other_textarea').show();        } else {            $('#other_textarea').hide();        }    }    //google.maps.event.addDomListener(window, 'load', initialize);</script><i id="preload" class="fa fa-check-circle-o fa-2x"></i><div id="page-container" class="page-container">    <div class="row center-block content_center">        <div class="details_bottom">            <div class="col-xs-12 text-center   " style=" margin-bottom:0px; padding-bottom: 0px;"  ><img style="border-radius: 50%; width: 120px; height: 120px;  object-fit: contain" src="<?php echo $companyLogo;?>"/> </div>            <div class="col-xs-12 text-center order_title_text" style="margin-bottom:35px; margin-top:-9px; " ><?php echo $companyName; ?></div>            <div class="col-xs-12 text-center order_title_text"><?php echo $title; ?></div>            <div class="col-xs-10 col-xs-offset-1 text-center order_title_description"><?php echo $subtitle; ?></div>     <!--       <div class="order_row col-xs-11 col-xs-offset-1 col-md-9 col-md-offset-2">                <div class="col-xs-3 order_col text-center">                    <div class="<?php if($currentState>=1){ echo 'order_icon_completed';}else{echo 'order_icon_incompleted';}; ?>"></div>                    <div class="order_step_title <?php if($currentState>=1){ echo 'order_step_completed';}; ?>"><?php echo $states[0]; ?></div>                </div>                <div class="order_seperator col-xs-1 text-center <?php if($currentState>1){ echo 'order_seperator_completed';}; ?>">.....</div>                <div class="col-xs-3 order_col text-center">                    <div class="<?php if($currentState>=2){ echo 'order_icon_completed';}else{echo 'order_icon_incompleted';}; ?>"></div>                    <div class="order_step_title <?php if($currentState>=2){ echo 'order_step_completed';}; ?>"><?php echo $states[1]; ?></div>                </div>                <div class="order_seperator col-xs-1 text-center <?php if($currentState>2){ echo 'order_seperator_completed';}; ?>">.....</div>                <div class="col-xs-3 order_col text-center">                    <div class="<?php if($currentState>=3){ echo 'order_icon_completed';}else{echo 'order_icon_incompleted';}; ?>"></div>                    <div class="order_step_title <c-rating                    ?php if($currentState>=3){ echo 'order_step_completed';}; ?>"><?php echo $states[2]; ?></div>                </div>            </div> !-->        </div>        <div class="details_bottom_feedback">            <div class="col-xs-12 col-md-10 col-md-offset-1 text-center order_feedback_title" style="position:relative"><?php echo $feedbackTitle; ?></div>                <div  >                  <ul  class="col-xs-12 col-md-10 col-md-offset-1 text-center" style="display:inline; "  >                      <li style="display:inline; margin-right:10px; top:10px;"  ><img id="f1" class="emojiImg" src="<?php echo base_url(); ?>images/emoji/1.png" /></li>                      <li style="display:inline; margin-right:10px; top:10px; "  ><img id="f2" class="emojiImg" src="<?php echo base_url(); ?>images/emoji/2.png" /></li>                      <li style="display:inline; margin-right:10px; top:10px;" ><img  id="f3" class="emojiImg" src="<?php echo base_url(); ?>images/emoji/3.png" /></li>                      <li style="display:inline; margin-right:10px; top:10px; "  ><img id="f4" class="emojiImg" src="<?php echo base_url(); ?>images/emoji/4.png" /></li>                  </ul>                </div>            <div id="feedback_questions" class="feedback_questions" style="display: none;">                <div class="col-xs-12 col-md-10 col-md-offset-1 text-center order_feedback_questiontitle"><?php echo $feedbackSubtitle; ?></div>                <div id="questions_group" class="btn-group btn-group-vertical col-xs-12 col-md-10 col-md-offset-1" data-toggle="buttons">                    <?php foreach($feedbackOptions as $question) { ?>                    <label class="btn col-xs-12 col-md-10" >                        <input type="radio" name='gender1' value="<?php echo $question; ?>" onchange="radioValueChange();">                        <i class="fa fa-circle-o fa-2x"></i>                        <i class="fa fa-check-circle-o fa-2x"></i>                        <span> <?php echo $question; ?></span>                    </label>                    <?php } ?>                    <label class="btn">                        <input type="radio" name='gender1' value="other" onchange="radioValueChange();"><i class="fa fa-circle-o fa-2x"></i><i class="fa fa-check-circle-o fa-2x"></i><span> Other, please specify</span>                    </label>                </div>            </div>            <div id="other_textarea" class="col-xs-10 col-xs-offset-1 col-md-8 col-md-offset-2" style="display: none" >                <textarea rows="4" id="other_textareainput" placeholder="Let us know what you think.." name="other_text" class="other_textarea"></textarea>            </div>        </div>        <div id="eddress_action_bar" class="col-xs-8 col-xs-offset-2 col-sm-4 col-sm-offset-4 order_action_button" style="display: none;">            <div id="feedback_div" class="details_blue_btn background_order_btn" style="cursor: pointer">                <div class="action_bar_text"><span>SUBMIT FEEDBACK</span></div>            </div>        </div>        <br />        <br clear="left"/>        <div class="text-center "  style="backgroundcolor:white;">            <img   style="display: inline; margin-right:3px; margin-top:3px; margin-bottom:8px; height:25px; width:25px;" src='<?php echo base_url(); ?>images/logo-small.png' /> <div style="display:inline-block; font-size:12pt;position: relative;top:0px;" >Powered by eddress</div>        </div>    </div></div><script src="<?php echo base_url(); ?>js/rating.min.js"></script><script>    (function() {        // INITIALIZE      (function init() {            // target element            var el = document.querySelector('.c-rating');            // current rating, or initial rating            var currentRating = 0;            // max rating, i.e. number of stars you want            var maxRating= 4;            // callback to run after setting the rating            var callback = function(rating) {                ratingValue = rating;                if(ratingValue != 0)                {                    $('#eddress_action_bar').show();                }else{                    $('#eddress_action_bar').hide();                }                if(ratingValue<4)                {                    $('#feedback_questions').show();                }else{                    $('#feedback_questions').hide();                }            };            // rating instance            var myRating = rating(el, currentRating, maxRating, callback);    })();    })();</script>